01) Logue-se na console do CentOS (usuário/senha: aluno/@lun0123). Execute:
$ ls -la
$ cat ~/.pos-install.sh
$ startx

02) No ambiente gráfico, abra um novo terminal e execute:
$ ~/.pos-install.sh

03) Faça o logout do usuário (isso retirará você do modo gráfico);

04) Execute novamente o comando a seguir. Redimensione a tela para verificar se o VirtualBox Guest Additions realmente está funcionando.
$ startx

05) Faça novamente o logout do usuário e execute os comandos a seguir:
$ ping base
$ ssh base
$ logout
$ ssh-keygen
$ ssh-copy-id base
$ ssh base
$ logout
$ ssh -R 3333:localhost:22 base

06) Abra outro shell, na máquina base, e execute:
$ ssh -p 3333 localhost
$ logout
$ ssh-keygen

07) Se estiver no Mac OS X, você tentará executar o comando ssh-copy-id e verificará que ele não será encontrado. Uma solução para esse problema é baixar o meu projeto dotfiles que contém um script com esse nome/utilidade. Outros scripts desse projeto também serão utilizados mais a frente. Então, baixe e instale esse projeto com os seguintes comandos (será necessário que o Git esteja instalado):
$ git clone https://github.com/paulojeronimo/dotfiles.git
$ dotfiles/install
$ logout

08) Abra um novo shell na máquina base (note que seu prompt deverá estar modificado). Execute:
$ ssh-copy-id -p 3333 localhost

09) Teste um novo ssh para a máquina vm-centos. Agora, nenhuma senha deverá ser solicitada:
$ ssh -p 3333 localhost
$ logout

10) Desligue a vm-centos
$ ssh -t -p 3333 localhost 'sudo shutdown -h now'
# aguarde o shutdown ...

11) Crie uma nova interface de rede na vm-centos. Isso será útil para evitarmos o uso do túnel reverso utilizamos agora a pouco. Ela também será útil nos laboratórios de JBoss em que formos levantar mais de uma instância;
$ VBoxManage hostonlyif create
$ VBoxManage list hostonlyifs
$ VBoxManage dhcpserver add --netname HostInterfaceNetworking-vboxnet0 --ip 192.168.56.1 --netmask 255.255.255.0 --lowerip 192.168.56.101 --upperip 192.168.56.201 --enable
$ VBoxManage list dhcpservers
$ VBoxManage modifyvm vm-centos --nic2 hostonly --hostonlyadapter2 vboxnet0
$ f=/etc/hosts; grep vm-centos $f &> /dev/null || echo -e "192.168.56.101\tvm-centos" | sudo tee -a $f
$ cat $f
$ VBoxManage startvm vm-centos
$ ping vm-centos

11) Desligue novamente a VM e, agora, faça um snapshot dela para caso precisemos voltar até o ponto em que chegamos:
$ VBoxManage controlvm vm-centos acpipowerbutton
$ VBoxManage snapshot vm-centos take 'centos-pos-install'

FIM DESSE LAB!!! \0/

##############################################################################
# Comandos para desfazer a rede (referência para o futuro, NÃO EXECUTE AGORA):
##############################################################################

# Para remover o servidor dhcp da interface vboxnet0:
$ VBoxManage dhcpserver remove --netname HostInterfaceNetworking-vboxnet0

# Para remover a rede vboxnet0
$ VBoxManage hostonlyif remove vboxnet0
